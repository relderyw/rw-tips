<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RW Tips - Dashboard ESoccer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Oxanium:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Oxanium', sans-serif;
            background: #000000;
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            padding-left: 70px;
            transition: padding-left 0.3s ease;
        }

        :root {
            /* Variáveis do código principal */
            --primary-color: #2980b9;
            --secondary-color: #00ff73;
            --accent-color: #1abc9c;
            --highlight-color: #00fa15;
            --text-color: #ecf0f1;
            --dark-bg: #121212;
            --progress-bg: rgba(255, 255, 255, 0.1);
            --progress-fill: linear-gradient(90deg, #2980b9, #00ff73);
            /* Variáveis da sidebar */
            --sidebar-primary-color: #2980b9;
            --sidebar-accent-color: #00ff73;
            --sidebar-border-color: rgba(255, 255, 255, 0.05);
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            width: 70px;
            background: rgba(17, 24, 39, 0.95);
            backdrop-filter: blur(10px);
            border-right: 1px solid var(--sidebar-border-color);
            transition: width 0.3s ease;
            z-index: 1000;
            overflow: hidden;
        }

        .sidebar:hover {
            width: 260px;
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            padding: 20px 15px;
            gap: 15px;
            border-bottom: 1px solid var(--sidebar-border-color);
            white-space: nowrap;
        }

        .sidebar-logo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 700;
            background: linear-gradient(45deg, var(--sidebar-accent-color), #60a5fa);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .sidebar:hover .sidebar-title {
            opacity: 1;
        }

        .sidebar-menu {
            list-style: none;
            padding: 20px 0;
        }

        .sidebar-menu li {
            margin: 5px 0;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            color: var(--text-color);
            text-decoration: none;
            transition: all 0.3s ease;
            gap: 15px;
            white-space: nowrap;
        }

        .sidebar-menu a:hover {
            background: rgba(59, 130, 246, 0.1);
            color: var(--sidebar-accent-color);
            transform: translateX(5px);
        }

        .sidebar-menu li.active a {
            background: linear-gradient(90deg, rgba(0, 255, 136, 0.2), transparent);
            color: var(--sidebar-accent-color);
            border-left: 3px solid var(--sidebar-accent-color);
        }

        .sidebar-menu .icon {
            font-size: 1.3rem;
            width: 30px;
            text-align: center;
            flex-shrink: 0;
        }

        .sidebar-menu .label {
            opacity: 0;
            transition: opacity 0.3s ease;
            font-weight: 500;
        }

        .sidebar:hover .sidebar-menu .label {
            opacity: 1;
        }

        .header {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            padding: 20px;
            text-align: center;
            border-bottom: 2px solid var(--primary-color);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .logo-img {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid var(--primary-color);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from {
                box-shadow: 0 0 10px var(--primary-color);
            }

            to {
                box-shadow: 0 0 20px var(--primary-color), 0 0 30px var(--secondary-color);
            }
        }

        .logo-text {
            font-size: 2.5rem;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--secondary-color);
            margin-top: 5px;
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.5rem;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-left: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .dashboard {
            padding: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .summary-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid var(--primary-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(41, 128, 185, 0.2);
        }

        .card-title {
            font-size: 1.1rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-value {
            font-size: 2.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #fff, var(--primary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .leagues-section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 2rem;
            margin-bottom: 20px;
            text-align: center;
            color: var(--secondary-color);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .leagues-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .league-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid var(--primary-color);
            transition: all 0.3s ease;
        }

        .league-card:hover {
            transform: scale(1.02);
            border-color: var(--secondary-color);
        }

        .league-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
        }

        .stats-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-label {
            color: var(--accent-color);
            flex: 1;
            min-width: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .stat-value {
            font-weight: bold;
            color: #fff;
            flex: 0 0 80px;
            text-align: right;
            margin-right: 10px;
        }

        .progress-bar {
            flex: 2;
            height: 10px;
            background: var(--progress-bg);
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--progress-fill);
            border-radius: 5px;
            transition: width 0.6s ease-in-out;
            position: absolute;
            top: 0;
            left: 0;
        }

        .stats-group {
            margin-bottom: 20px;
        }

        .group-title {
            font-size: 1.1rem;
            color: var(--highlight-color);
            margin-bottom: 10px;
            border-bottom: 1px solid var(--highlight-color);
            padding-bottom: 5px;
        }

        .players-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .players-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid var(--primary-color);
        }

        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .player-name {
            font-weight: bold;
            color: #fff;
        }

        .player-stats {
            color: var(--accent-color);
            font-size: 0.9rem;
        }

        .player-league {
            color: var(--highlight-color);
            font-size: 0.85rem;
            margin-top: 3px;
            font-style: italic;
        }

        .player-badge {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 10px;
            padding: 12px 15px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .player-badge:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        .best-players-by-league,
        .best-defenders-by-league {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }

        .section-subtitle {
            font-size: 1rem;
            margin-bottom: 15px;
            text-align: left;
            color: var(--highlight-color);
            border-bottom: 1px solid var(--highlight-color);
            padding-bottom: 5px;
            width: 100%;
        }

        .methods-section {
            margin-bottom: 40px;
        }

        .method-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid var(--primary-color);
            transition: all 0.3s ease;
        }

        .method-card:hover {
            transform: scale(1.02);
            border-color: var(--secondary-color);
        }

        .method-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
        }

        .status-over {
            color: var(--accent-color);
            font-weight: bold;
        }

        .status-not-over {
            color: #ff4d4d;
            font-weight: bold;
        }

        .filter-container {
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.5));
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(41, 128, 185, 0.3);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            margin-bottom: 25px;
        }

        #gameFilter {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: 1px solid var(--primary-color);
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            outline: none;
            box-shadow: 0 4px 15px rgba(41, 128, 185, 0.2);
        }

        #gameFilter:hover,
        #gameFilter:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 15px rgba(41, 128, 185, 0.6);
        }

        #gameFilter option {
            background: rgba(0, 0, 0, 0.9);
            color: var(--primary-color);
        }

        .proxy-btn {
            background: linear-gradient(145deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 30px;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(41, 128, 185, 0.4);
            margin: 5px;
        }

        .proxy-btn:hover {
            background: linear-gradient(145deg, var(--secondary-color), var(--primary-color));
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(41, 128, 185, 0.6);
        }

        .highlight {
            background: linear-gradient(45deg, rgba(243, 156, 18, 0.2), rgba(243, 156, 18, 0.1));
            border-radius: 10px;
            padding: 5px 10px;
            color: var(--highlight-color) !important;
            font-weight: bold;
        }

        .error-message {
            text-align: center;
            color: #ff4d4d;
            font-size: 1.2rem;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            body {
                padding-left: 60px;
            }

            .sidebar {
                width: 60px;
            }

            .sidebar:hover {
                width: 220px;
            }

            .dashboard {
                padding: 20px 15px;
            }

            .logo-text {
                font-size: 2rem;
            }

            .summary-grid {
                grid-template-columns: 1fr;
            }

            .leagues-grid {
                grid-template-columns: 1fr;
            }

            .stats-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .progress-bar {
                width: 100%;
            }

            .stat-value {
                text-align: left;
                margin-right: 0;
            }
        }
    </style>
</head>

<body>
    <!-- Sidebar -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <img src="https://i.ibb.co/G4Y8sHM/Chat-GPT-Image-21-de-abr-de-2025-16-14-34-1.png" alt="RW Tips"
                class="sidebar-logo">
            <span class="sidebar-title">RW TIPS</span>
        </div>
        <ul class="sidebar-menu">
            <li><a href="visualization.html"><span class="icon">⚽</span><span class="label">Próximos Jogos</span></a>
            </li>
            <li><a href="results.html"><span class="icon">📊</span><span class="label">Últimos Resultados</span></a>
            </li>
            <li><a href="live.html"><span class="icon">🔴</span><span class="label">AO VIVO</span></a></li>
            <li><a href="statistics.html"><span class="icon">📈</span><span class="label">Estatísticas das
                        Ligas</span></a></li>
            <li><a href="bets.html"><span class="icon">💰</span><span class="label">Registrar Apostas</span></a></li>
            <li><a href="players.html"><span class="icon">🎮</span><span class="label">Análise de Jogadores</span></a>
            </li>
            <li class="active"><a href="dashboard.html"><span class="icon">📋</span><span
                        class="label">Dashboard</span></a></li>
            <li><a href="nba.html"><span class="icon">🏀</span><span class="label">NBA Stats</span></a></li>
            <li><a href="radar.html"><span class="icon">🎯</span><span class="label">Radar</span></a></li>
            <li><a href="over.html"><span class="icon">📍</span><span class="label">Over Analysis</span></a></li>
        </ul>
    </nav>

    <div class="header">
        <div class="logo-container">
            <img src="https://i.ibb.co/G4Y8sHMk/Chat-GPT-Image-21-de-abr-de-2025-16-14-34-1.png" alt="RW Tips Logo"
                class="logo-img">
            <h1 class="logo-text">👑 𝗥𝗪 𝗧𝗜𝗣𝗦 🎮</h1>
        </div>
        <p class="subtitle">Dashboard de Análise ESoccer - Termômetro do Mercado</p>
    </div>
    <div id="loading" class="loading">
        <div class="spinner"></div>
        <p>Carregando dados das partidas...</p>
    </div>
    <div id="error" class="error-message" style="display: none;">
        <p>Erro ao carregar dados da API. Verifique o console para mais detalhes.</p>
        <div id="cors-options" style="margin-top: 15px; display: none;">
            <p><strong>Tentar com outro proxy CORS:</strong></p>
            <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; margin-top: 10px;">
                <button onclick="tryWithProxy(0)" class="proxy-btn">Sem Proxy</button>
                <button onclick="tryWithProxy(1)" class="proxy-btn">Proxy 1</button>
                <button onclick="tryWithProxy(2)" class="proxy-btn">Proxy 2</button>
                <button onclick="tryWithProxy(3)" class="proxy-btn">Proxy 3</button>
            </div>
        </div>
    </div>
    <div id="dashboard" class="dashboard" style="display: none;">
        <div class="filter-container" style="text-align: center; margin-bottom: 20px;">
            <label for="gameFilter" style="color: #39FF14; margin-right: 10px;">Filtrar por:</label>
            <select id="gameFilter" onchange="applyFilter()"
                style="background: rgba(57, 255, 20, 0.1); color: white; border: 1px solid #39FF14; padding: 8px; border-radius: 5px;">
                <option value="all">Todos os jogos</option>
                <option value="15">Últimos 15 jogos</option>
                <option value="10">Últimos 10 jogos</option>
                <option value="5">Últimos 5 jogos</option>
            </select>
        </div>
        <div class="summary-grid">
            <div class="summary-card">
                <div class="card-title">⚽ Total de Partidas</div>
                <div class="card-value" id="totalGames">0</div>
                <p id="matchesCount">Jogos analisados: <span id="totalMatchesCount">0</span></p>
            </div>
            <div class="summary-card">
                <div class="card-title">🎯 Média Geral de Gols</div>
                <div class="card-value" id="avgGoals">0.0</div>
                <p>Tempo completo (FT)</p>
            </div>
            <div class="summary-card">
                <div class="card-title">⏱️ Média HT</div>
                <div class="card-value" id="avgHT">0.0</div>
                <p>Primeiro tempo (HT)</p>
            </div>
            <div class="summary-card">
                <div class="card-title">🏆 Ambos Marcam</div>
                <div class="card-value" id="bothScore">0%</div>
                <p>Percentual BTTS</p>
            </div>
        </div>
        <div class="leagues-section">
            <h2 class="section-title">📊 Análise por Liga</h2>
            <div id="leaguesGrid" class="leagues-grid"></div>
        </div>
        <div class="players-section">
            <div class="players-card">
                <h3 class="section-title">🌟 Top Players (Mais Gols)</h3>
                <div id="topScorers"></div>
            </div>
            <div class="players-card">
                <h3 class="section-title">🛡️ Melhores Defesas</h3>
                <div id="bestDefenders"></div>
            </div>
        </div>
        <div class="methods-section">
            <h2 class="section-title">Avaliação de Métodos</h2>
            <div id="methodsGrid" class="leagues-grid"></div>
        </div>
    </div>
    <button class="refresh-btn" onclick="loadData()" title="Atualizar Dados">🔄</button>

    <style>
        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            height: 40px;
            border-radius: 20px;
            background: linear-gradient(145deg, var(--primary-color), var(--secondary-color));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            box-shadow: 0 5px 15px rgba(41, 128, 185, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            z-index: 1000;
            padding: 0 20px;
        }

        .back-btn:hover {
            transform: scale(1.05);
            background: linear-gradient(145deg, var(--secondary-color), var(--primary-color));
            box-shadow: 0 7px 20px rgba(41, 128, 185, 0.6);
        }

        .refresh-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--accent-color);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .refresh-btn:hover {
            transform: scale(1.1);
            background: var(--primary-color);
            box-shadow: 0 7px 20px rgba(0, 0, 0, 0.4);
        }

        .best-player,
        .best-league {
            position: relative;
            border: 2px solid var(--highlight-color) !important;
            box-shadow: 0 0 15px var(--highlight-color) !important;
        }

        .best-player::before,
        .best-league::before {
            content: '🏆';
            position: absolute;
            top: -15px;
            right: -15px;
            background: var(--highlight-color);
            color: #000;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            z-index: 10;
        }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Verificar login
            if (!sessionStorage.getItem('loggedIn')) {
                window.location.href = 'index.html';
                return;
            }

            // Marcar item ativo na sidebar
            const currentPath = window.location.pathname.split('/').pop() || 'dashboard.html';
            const menuItems = document.querySelectorAll('.sidebar-menu a');
            menuItems.forEach(item => {
                if (item.getAttribute('href') === currentPath) {
                    item.parentElement.classList.add('active');
                }
            });
        });

        let allMatches = [];
        let filteredMatches = [];
        let leagueStats = {};
        let playerStats = {};
        let leagueMatches = {};

        const corsProxies = [
            (url) => url,
            (url) => `https://corsproxy.io/?${encodeURIComponent(url)}`,
            (url) => `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`,
            (url) => `https://proxy.cors.sh/${url}`
        ];

        let currentProxyIndex = 0;

        function tryWithProxy(proxyIndex) {
            currentProxyIndex = proxyIndex;
            document.getElementById('cors-options').style.display = 'none';
            loadData();
        }

        async function fetchMatches() {
            console.log('Iniciando busca de resultados...');
            try {
                const originalUrl = `https://api-v2.green365.com.br/api/v2/sport-events?page=1&limit=150&sport=esoccer&status=ended`;
                const proxyUrl = corsProxies[currentProxyIndex](originalUrl);
                console.log(`Usando proxy ${currentProxyIndex}: ${proxyUrl}`);

                const response = await fetch(proxyUrl, {
                    headers: {},
                    mode: 'cors',
                    credentials: 'omit',
                    signal: AbortSignal.timeout(10000)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status} ${response.statusText}`);
                }

                const data = await response.json();
                console.log('Dados recebidos:', data);

                if (!data.items || !Array.isArray(data.items)) {
                    throw new Error('Estrutura de dados inválida: "items" não encontrado ou não é um array');
                }

                const validMatches = data.items.filter(match => {
                    return (
                        match.competition?.name &&
                        match.score?.home !== undefined &&
                        match.score?.away !== undefined &&
                        match.scoreHT?.home !== undefined &&
                        match.scoreHT?.away !== undefined &&
                        match.home?.name &&
                        match.away?.name
                    );
                });

                if (validMatches.length === 0) {
                    throw new Error('Nenhum dado válido retornado pela API');
                }

                console.log(`Partidas válidas encontradas: ${validMatches.length}`);
                return validMatches;
            } catch (error) {
                console.error('Erro ao buscar dados:', error);
                document.getElementById('cors-options').style.display = 'block';
                document.getElementById('error').style.display = 'block';
                document.getElementById('error').innerHTML = `
                    <p>Erro ao carregar dados da API: ${error.message}</p>
                    <p>Possíveis soluções:</p>
                    <ol>
                        <li>Tente recarregar a página clicando no botão 🔄 abaixo</li>
                        <li>Instale uma extensão para desbloquear CORS como:
                            <ul>
                                <li><a href="https://chrome.com/webstore/detail/cors-unblock/lfhmikememgdcahcdlaciloancbhjino" target="_blank" style="color: var(--highlight-color);">CORS Unblock para Chrome</a></li>
                                <li><a href="https://addons.mozilla.org/pt-BR/firefox/addon/cors-everywhere/" target="_blank" style="color: var(--highlight-color);">CORS Everywhere para Firefox</a></li>
                            </ul>
                        </li>
                        <li>Abra o arquivo localmente em vez de um servidor</li>
                        <li>Se você é desenvolvedor, execute o site em um servidor local com CORS habilitado</li>
                    </ol>
                    <p>Detalhes técnicos: O erro 403 Forbidden ocorre porque o servidor da API está bloqueando requisições de origens diferentes (CORS).</p>
                `;
                return [];
            }
        }

        async function loadData() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('error').style.display = 'none';

            allMatches = await fetchMatches();

            if (allMatches.length === 0) {
                console.error('Nenhum dado retornado pela API. Verifique o endpoint ou autenticação.');
                document.getElementById('error').style.display = 'block';
                return;
            }

            organizeMatchesByLeague();
            applyFilter();

            document.getElementById('loading').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
        }

        function organizeMatchesByLeague() {
            leagueMatches = {};

            allMatches.forEach(match => {
                const league = match.competition?.name || 'Desconhecida';

                if (!leagueMatches[league]) {
                    leagueMatches[league] = [];
                }

                leagueMatches[league].push(match);
            });

            Object.keys(leagueMatches).forEach(league => { });
        }

        function applyFilter() {
            const filterValue = document.getElementById('gameFilter').value;
            filteredMatches = [];

            Object.keys(leagueMatches).forEach(league => {
                const leagueMatchList = leagueMatches[league];
                let matchesToInclude;

                if (filterValue === 'all') {
                    matchesToInclude = leagueMatchList;
                } else {
                    const count = parseInt(filterValue);
                    matchesToInclude = leagueMatchList.slice(0, count);
                }

                filteredMatches = filteredMatches.concat(matchesToInclude);
            });

            document.getElementById('totalMatchesCount').textContent = filteredMatches.length;

            analyzeData();
            updateDashboard();
            evaluateMethods();
        }

        function analyzeData() {
            leagueStats = {};
            playerStats = {};
            filteredMatches.forEach(match => {
                const league = match.competition?.name || 'Desconhecida';
                const totalGoals = (match.score?.home || 0) + (match.score?.away || 0);
                const htGoals = (match.scoreHT?.home || 0) + (match.scoreHT?.away || 0);
                const bothScored = (match.score?.home || 0) > 0 && (match.score?.away || 0) > 0;
                const isZeroZero = (match.score?.home || 0) === 0 && (match.score?.away || 0) === 0;
                const bttsHT = (match.scoreHT?.home || 0) > 0 && (match.scoreHT?.away || 0) > 0;
                const zeroHT = htGoals === 0;
                const zeroFT = totalGoals === 0;

                if (!leagueStats[league]) {
                    leagueStats[league] = {
                        games: 0,
                        totalGoals: 0,
                        totalHtGoals: 0,
                        bothScore: 0,
                        zeroZero: 0,
                        over15: 0,
                        over25: 0,
                        over35: 0,
                        over15HT: 0,
                        over25HT: 0,
                        over30HT: 0,
                        bttsHT: 0,
                        zeroHT: 0,
                        zeroFT: 0,
                        over50FT: 0,
                        over55FT: 0,
                        over60FT: 0
                    };
                }

                leagueStats[league].games++;
                leagueStats[league].totalGoals += totalGoals;
                leagueStats[league].totalHtGoals += htGoals;
                if (bothScored) leagueStats[league].bothScore++;
                if (isZeroZero) leagueStats[league].zeroZero++;
                if (totalGoals > 1.5) leagueStats[league].over15++;
                if (totalGoals > 2.5) leagueStats[league].over25++;
                if (totalGoals > 3.5) leagueStats[league].over35++;
                if (htGoals > 1.5) leagueStats[league].over15HT++;
                if (htGoals > 2.5) leagueStats[league].over25HT++;
                if (htGoals > 3) leagueStats[league].over30HT++;
                if (bttsHT) leagueStats[league].bttsHT++;
                if (zeroHT) leagueStats[league].zeroHT++;
                if (zeroFT) leagueStats[league].zeroFT++;
                if (totalGoals > 5) leagueStats[league].over50FT++;
                if (totalGoals > 5.5) leagueStats[league].over55FT++;
                if (totalGoals > 6) leagueStats[league].over60FT++;

                [match.home?.name || 'Jogador Desconhecido', match.away?.name || 'Jogador Desconhecido'].forEach((player, index) => {
                    if (!playerStats[player]) {
                        playerStats[player] = {
                            games: 0,
                            goalsFor: 0,
                            goalsAgainst: 0,
                            goalsForHT: 0,
                            goalsAgainstHT: 0,
                            wins: 0,
                            draws: 0,
                            losses: 0,
                            league: match.competition?.name || 'Liga Desconhecida'
                        };
                    }

                    playerStats[player].games++;
                    if (index === 0) {
                        playerStats[player].goalsFor += match.score?.home || 0;
                        playerStats[player].goalsAgainst += match.score?.away || 0;
                        playerStats[player].goalsForHT += match.scoreHT?.home || 0;
                        playerStats[player].goalsAgainstHT += match.scoreHT?.away || 0;
                        if ((match.score?.home || 0) > (match.score?.away || 0)) playerStats[player].wins++;
                        else if ((match.score?.home || 0) === (match.score?.away || 0)) playerStats[player].draws++;
                        else playerStats[player].losses++;
                    } else {
                        playerStats[player].goalsFor += match.score?.away || 0;
                        playerStats[player].goalsAgainst += match.score?.home || 0;
                        playerStats[player].goalsForHT += match.scoreHT?.away || 0;
                        playerStats[player].goalsAgainstHT += match.scoreHT?.home || 0;
                        if ((match.score?.away || 0) > (match.score?.home || 0)) playerStats[player].wins++;
                        else if ((match.score?.home || 0) === (match.score?.away || 0)) playerStats[player].draws++;
                        else playerStats[player].losses++;
                    }
                });
            });
        }

        const leagueMapping = {
            "Esoccer Battle - 8 mins play": { name: "Battle 8m", color: "#FF4C4C" },
            "Esoccer Battle Volta - 6 mins play": { name: "Battle Volta 6m", color: "#FFD700" },
            "Esoccer GT Leagues – 12 mins play": { name: "GT Leagues 12m", color: "#32CD32" },
            "Esoccer H2H GG League - 8 mins play": { name: "H2H GG 8m", color: "#8A2BE2" },
            "Esoccer Adriatic League - 10 mins play": { name: "Adriatic 10m", color: "#1E90FF" }
        };

        function updateDashboard() {
            const totalGames = filteredMatches.length;
            const totalGoals = filteredMatches.reduce((sum, match) => sum + (match.score?.home || 0) + (match.score?.away || 0), 0);
            const totalHtGoals = filteredMatches.reduce((sum, match) => sum + (match.scoreHT?.home || 0) + (match.scoreHT?.away || 0), 0);
            const bothScoreCount = filteredMatches.filter(match => (match.score?.home || 0) > 0 && (match.score?.away || 0) > 0).length;

            document.getElementById('totalGames').textContent = totalGames;
            document.getElementById('avgGoals').textContent = (totalGoals / totalGames).toFixed(1);
            document.getElementById('avgHT').textContent = (totalHtGoals / totalGames).toFixed(1);
            document.getElementById('bothScore').textContent = Math.round((bothScoreCount / totalGames) * 100) + '%';

            const leaguesGrid = document.getElementById('leaguesGrid');
            leaguesGrid.innerHTML = '';

            let bestLeague = '';
            let highestAvgGoals = 0;

            Object.entries(leagueStats).forEach(([league, stats]) => {
                const avgGoals = stats.totalGoals / stats.games;
                if (avgGoals > highestAvgGoals && stats.games >= 3) {
                    highestAvgGoals = avgGoals;
                    bestLeague = league;
                }
            });

            Object.entries(leagueStats).forEach(([league, stats]) => {
                const avgGoals = (stats.totalGoals / stats.games).toFixed(1);
                const avgHt = (stats.totalHtGoals / stats.games).toFixed(1);
                const bothScorePerc = Math.round((stats.bothScore / stats.games) * 100);
                const over25Perc = Math.round((stats.over25 / stats.games) * 100);
                const bttsHTPerc = Math.round((stats.bttsHT / stats.games) * 100);
                const over25HTPerc = Math.round((stats.over25HT / stats.games) * 100);
                const over35Perc = Math.round((stats.over35 / stats.games) * 100);
                const zeroHTPerc = Math.round((stats.zeroHT / stats.games) * 100);
                const zeroFTPerc = Math.round((stats.zeroZero / stats.games) * 100);

                const leagueInfo = leagueMapping[league] || { name: league, color: "#FFFFFF" };
                const leagueCard = document.createElement('div');
                leagueCard.className = 'league-card';
                leagueCard.style.background = `linear-gradient(145deg, ${leagueInfo.color}22, ${leagueInfo.color}44)`;
                leagueCard.style.borderColor = leagueInfo.color;
                if (league === bestLeague) {
                    leagueCard.classList.add('best-league');
                }

                leagueCard.innerHTML = `
                    <div class="league-name">${leagueInfo.name}</div>
                    <div class="stats-row">
                        <span class="stat-label">Partidas:</span>
                        <span class="stat-value">${stats.games}</span>
                    </div>
                    <div class="group-title">Mercados HT</div>
                    <div class="stats-row">
                        <span class="stat-label">Média Gols HT:</span>
                        <span class="stat-value">${avgHt}</span>
                    </div>
                    <div class="stats-row">
                        <span class="stat-label">Ambos Marcam HT:</span>
                        <span class="stat-value">${bttsHTPerc}%</span>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${bttsHTPerc}%"></div>
                        </div>
                    </div>
                    <div class="stats-row">
                        <span class="stat-label">Over 2.5 HT:</span>
                        <span class="stat-value">${over25HTPerc}%</span>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${over25HTPerc}%"></div>
                        </div>
                    </div>
                    <div class="stats-row">
                        <span class="stat-label">0x0 HT:</span>
                        <span class="stat-value">${zeroHTPerc}%</span>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${zeroHTPerc}%"></div>
                        </div>
                    </div>
                    <div class="group-title">Mercados FT</div>
                    <div class="stats-row">
                        <span class="stat-label">Média Gols FT:</span>
                        <span class="stat-value">${avgGoals}</span>
                    </div>
                    <div class="stats-row">
                        <span class="stat-label">Ambos Marcam:</span>
                        <span class="stat-value">${bothScorePerc}%</span>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${bothScorePerc}%"></div>
                        </div>
                    </div>
                    <div class="stats-row">
                        <span class="stat-label">Over 2.5:</span>
                        <span class="stat-value">${over25Perc}%</span>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${over25Perc}%"></div>
                        </div>
                    </div>
                    <div class="stats-row">
                        <span class="stat-label">Over 3.5:</span>
                        <span class="stat-value">${over35Perc}%</span>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${over35Perc}%"></div>
                        </div>
                    </div>
                    <div class="stats-row">
                        <span class="stat-label">0x0:</span>
                        <span class="stat-value">${zeroFTPerc}%</span>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${zeroFTPerc}%"></div>
                        </div>
                    </div>
                `;
                leaguesGrid.appendChild(leagueCard);
            });

            const playersByLeague = {};
            Object.entries(playerStats).forEach(([player, stats]) => {
                if (stats.games >= 3) {
                    if (!playersByLeague[stats.league]) {
                        playersByLeague[stats.league] = [];
                    }
                    playersByLeague[stats.league].push([player, stats]);
                }
            });

            const bestPlayersByLeague = {};
            Object.entries(playersByLeague).forEach(([league, players]) => {
                if (players.length > 0) {
                    players.sort((a, b) => b[1].goalsFor - a[1].goalsFor);
                    bestPlayersByLeague[league] = players[0][0];
                }
            });

            const sortedPlayers = Object.entries(playerStats)
                .filter(([_, stats]) => stats.games >= 3)
                .sort((a, b) => b[1].goalsFor - a[1].goalsFor);

            const topScorers = document.getElementById('topScorers');
            topScorers.innerHTML = '';

            const bestPlayer = sortedPlayers.length > 0 ? sortedPlayers[0][0] : null;

            const bestPlayersSectionTitle = document.createElement('div');
            bestPlayersSectionTitle.className = 'section-subtitle';
            bestPlayersSectionTitle.innerHTML = 'Melhores Jogadores por Liga:';
            topScorers.appendChild(bestPlayersSectionTitle);

            const bestPlayersContainer = document.createElement('div');
            bestPlayersContainer.className = 'best-players-by-league';

            Object.entries(bestPlayersByLeague).forEach(([league, player]) => {
                const stats = playerStats[player];
                const leagueInfo = leagueMapping[league] || { name: league, color: '#FFFFFF' };
                const avgGoalsFT = (stats.goalsFor / stats.games).toFixed(1);
                const avgGoalsHT = (stats.goalsForHT / stats.games).toFixed(1);

                const playerBadge = document.createElement('div');
                playerBadge.className = 'player-badge';
                playerBadge.style.background = `linear-gradient(145deg, ${leagueInfo.color}22, ${leagueInfo.color}44)`;
                playerBadge.style.border = `2px solid ${leagueInfo.color}`;

                playerBadge.innerHTML = `
                    <div style="font-weight: 700; color: ${leagueInfo.color}">${leagueInfo.name}</div>
                    <div style="font-weight: 700;">${player}</div>
                    <div style="font-size: 0.9rem;">${stats.goalsFor} gols em ${stats.games} jogos</div>
                    <div style="font-size: 1.1rem;">FT: ${avgGoalsFT}</div>
                    <div style="font-size: 1.1rem;">HT: ${avgGoalsHT}</div>
                `;

                if (player === bestPlayer) {
                    playerBadge.classList.add('best-player');
                }

                bestPlayersContainer.appendChild(playerBadge);
            });

            topScorers.appendChild(bestPlayersContainer);

            const defendersByLeague = {};
            Object.entries(playerStats).forEach(([player, stats]) => {
                if (stats.games >= 3) {
                    if (!defendersByLeague[stats.league]) {
                        defendersByLeague[stats.league] = [];
                    }
                    defendersByLeague[stats.league].push([player, stats]);
                }
            });

            const bestDefendersByLeague = {};
            Object.entries(defendersByLeague).forEach(([league, players]) => {
                if (players.length > 0) {
                    players.sort((a, b) => (a[1].goalsAgainst / a[1].games) - (b[1].goalsAgainst / b[1].games));
                    bestDefendersByLeague[league] = players[0][0];
                }
            });

            const bestDefense = Object.entries(playerStats)
                .filter(([_, stats]) => stats.games >= 3)
                .sort((a, b) => (a[1].goalsAgainst / a[1].games) - (b[1].goalsAgainst / b[1].games));

            const bestDefenders = document.getElementById('bestDefenders');
            bestDefenders.innerHTML = '';

            const bestDefender = bestDefense.length > 0 ? bestDefense[0][0] : null;

            const bestDefendersSectionTitle = document.createElement('div');
            bestDefendersSectionTitle.className = 'section-subtitle';
            bestDefendersSectionTitle.innerHTML = 'Melhores Defensores por Liga:';
            bestDefenders.appendChild(bestDefendersSectionTitle);

            const bestDefendersContainer = document.createElement('div');
            bestDefendersContainer.className = 'best-defenders-by-league';

            Object.entries(bestDefendersByLeague).forEach(([league, player]) => {
                const stats = playerStats[player];
                const avgConceded = (stats.goalsAgainst / stats.games).toFixed(1);
                const leagueInfo = leagueMapping[league] || { name: league, color: '#FFFFFF' };
                const avgGoalsFT = (stats.goalsFor / stats.games).toFixed(1);
                const avgGoalsAgainstFT = (stats.goalsAgainst / stats.games).toFixed(1);
                const avgGoalsHT = (stats.goalsForHT / stats.games).toFixed(1);
                const avgGoalsAgainstHT = (stats.goalsAgainstHT / stats.games).toFixed(1);

                const playerBadge = document.createElement('div');
                playerBadge.className = 'player-badge';
                playerBadge.style.background = `linear-gradient(145deg, ${leagueInfo.color}22, ${leagueInfo.color}44)`;
                playerBadge.style.border = `2px solid ${leagueInfo.color}`;

                playerBadge.innerHTML = `
                    <div style="font-weight: 700; color: ${leagueInfo.color}">${leagueInfo.name}</div>
                    <div style="font-weight: 700;">${player}</div>
                    <div style="font-size: 0.9rem;">${avgConceded} gols/jogo em ${stats.games} jogos</div>
                    <div style="font-size: 1.1rem;">FT: ${avgGoalsAgainstFT}</div>
                    <div style="font-size: 1.1rem;">HT: ${avgGoalsAgainstHT}</div>
                `;

                if (player === bestDefender) {
                    playerBadge.classList.add('best-player');
                }

                bestDefendersContainer.appendChild(playerBadge);
            });

            bestDefenders.appendChild(bestDefendersContainer);
        }

        function evaluateMethods() {
            const methodsGrid = document.getElementById('methodsGrid');
            methodsGrid.innerHTML = '';

            const methods = [
                {
                    name: "Over_Battle_Volta",
                    league: "Esoccer Battle Volta - 6 mins play",
                    conditions: [
                        { name: "Over 2.5 HT = 100%", check: (stats) => (stats.over25HT / stats.games) * 100 === 100, getPct: (stats) => Math.round((stats.over25HT / stats.games) * 100) },
                        { name: "Over 6.0 FT = 100%", check: (stats) => (stats.over60FT / stats.games) * 100 === 100, getPct: (stats) => Math.round((stats.over60FT / stats.games) * 100) },
                        { name: "BTTS HT = 100%", check: (stats) => (stats.bttsHT / stats.games) * 100 === 100, getPct: (stats) => Math.round((stats.bttsHT / stats.games) * 100) },
                        { name: "0 X 0 HT E FT = 0%", check: (stats) => (stats.zeroHT / stats.games) * 100 === 0 && (stats.zeroFT / stats.games) * 100 === 0, getPct: (stats) => `${Math.round((stats.zeroHT / stats.games) * 100)}% HT / ${Math.round((stats.zeroFT / stats.games) * 100)}% FT` }
                    ]
                },
                {
                    name: "TOP_CONFRONTO",
                    league: "Esoccer Battle - 8 mins play",
                    conditions: [
                        { name: "Over 2.5 HT = 100%", check: (stats) => (stats.over25HT / stats.games) * 100 === 100, getPct: (stats) => Math.round((stats.over25HT / stats.games) * 100) },
                        { name: "Over 5.0 FT >= 80%", check: (stats) => (stats.over50FT / stats.games) * 100 >= 80, getPct: (stats) => Math.round((stats.over50FT / stats.games) * 100) },
                        { name: "BTTS HT >= 89%", check: (stats) => (stats.bttsHT / stats.games) * 100 >= 89, getPct: (stats) => Math.round((stats.bttsHT / stats.games) * 100) },
                        { name: "0 X 0 HT = 0%", check: (stats) => (stats.zeroHT / stats.games) * 100 === 0, getPct: (stats) => Math.round((stats.zeroHT / stats.games) * 100) }
                    ]
                },
                {
                    name: "Over_HT_GT",
                    league: "Esoccer GT Leagues – 12 mins play",
                    conditions: [
                        { name: "Over 3.0 HT = 100%", check: (stats) => (stats.over30HT / stats.games) * 100 === 100, getPct: (stats) => Math.round((stats.over30HT / stats.games) * 100) },
                        { name: "BTTS HT = 100%", check: (stats) => (stats.bttsHT / stats.games) * 100 === 100, getPct: (stats) => Math.round((stats.bttsHT / stats.games) * 100) },
                        { name: "0 X 0 HT = 0%", check: (stats) => (stats.zeroHT / stats.games) * 100 === 0, getPct: (stats) => Math.round((stats.zeroHT / stats.games) * 100) }
                    ]
                },
                {
                    name: "H2H_OVER",
                    league: "Esoccer H2H GG League - 8 mins play",
                    conditions: [
                        { name: "Over 1.5 HT = 100%", check: (stats) => (stats.over15HT / stats.games) * 100 === 100, getPct: (stats) => Math.round((stats.over15HT / stats.games) * 100) },
                        { name: "Over 2.5 FT >= 90%", check: (stats) => (stats.over25 / stats.games) * 100 >= 90, getPct: (stats) => Math.round((stats.over25 / stats.games) * 100) },
                        { name: "BTTS HT >= 80%", check: (stats) => (stats.bttsHT / stats.games) * 100 >= 80, getPct: (stats) => Math.round((stats.bttsHT / stats.games) * 100) },
                        { name: "0 X 0 HT = 0%", check: (stats) => (stats.zeroHT / stats.games) * 100 === 0, getPct: (stats) => Math.round((stats.zeroHT / stats.games) * 100) }
                    ]
                },
                {
                    name: "Adriactic_100%",
                    league: "Esoccer Adriatic League - 10 mins play",
                    conditions: [
                        { name: "Over 3.0 HT = 100%", check: (stats) => (stats.over30HT / stats.games) * 100 === 100, getPct: (stats) => Math.round((stats.over30HT / stats.games) * 100) },
                        { name: "Over 5.5 FT = 100%", check: (stats) => (stats.over55FT / stats.games) * 100 === 100, getPct: (stats) => Math.round((stats.over55FT / stats.games) * 100) },
                        { name: "BTTS HT = 100%", check: (stats) => (stats.bttsHT / stats.games) * 100 === 100, getPct: (stats) => Math.round((stats.bttsHT / stats.games) * 100) },
                        { name: "0 X 0 HT = 0%", check: (stats) => (stats.zeroHT / stats.games) * 100 === 0, getPct: (stats) => Math.round((stats.zeroHT / stats.games) * 100) }
                    ]
                }
            ];

            methods.forEach(method => {
                const stats = leagueStats[method.league];
                const methodCard = document.createElement('div');
                methodCard.className = 'method-card';
                let html = `<div class="method-name">${method.name}</div>`;

                if (!stats || stats.games === 0) {
                    html += `<p style="color: #ff4d4d; text-align: center;">Nenhum dado disponível para esta liga.</p>`;
                } else {
                    let allConditionsMet = true;
                    html += '<div>';
                    method.conditions.forEach(cond => {
                        const met = cond.check(stats);
                        allConditionsMet = allConditionsMet && met;
                        const pct = cond.getPct(stats);
                        html += `<div class="stats-row">
                            <span class="stat-label">${cond.name}</span>
                            <span class="stat-value ${met ? 'highlight' : ''}">${met ? 'Sim' : 'Não'} (${pct}%)</span>
                        </div>`;
                    });
                    html += '</div>';
                    html += `<p style="text-align: center; margin-top: 15px; font-weight: 700; color: ${allConditionsMet ? '#39FF14' : '#ff4d4d'};">Status: ${allConditionsMet ? 'Over' : 'Not Over'}</p>`;
                }

                methodCard.innerHTML = html;
                methodsGrid.appendChild(methodCard);
            });
        }

        loadData();
        setInterval(loadData, 300000);
    </script>
</body>

</html>