<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RW TIPS - eSoccer</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-bg: #0f0f1a;
            --secondary-bg: #1a1a2e;
            --card-bg: #1e1e2e;
            --card-hover: #2a2a44;
            --text-primary: #ffffff;
            --text-secondary: #b0b0d0;
            --text-muted: #8080a0;
            --accent-blue: #4e79e6;
            --accent-green: #00cc99;
            --accent-red: #ff6b6b;
            --accent-yellow: #f1c40f;
            --accent-purple: #9b59b6;
            --accent-orange: #e67e22;
            --accent-pink: #e84393;
            --accent-cyan: #00cec9;

            /* Cores espec√≠ficas das ligas */
            --league-battle-8m: #FF4C4C;
            --league-battle-volta-6m: #FFD700;
            --league-gt-leagues-12m: #32CD32;
            --league-h2h-gg-8m: #8A2BE2;
            --league-adriatic-10m: #1E90FF;

            --border-radius: 12px;
            --box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s ease;
        }

        @keyframes bestMatchPulse {
            0% {
                box-shadow: 0 0 15px var(--accent-yellow);
                border-color: var(--accent-yellow);
            }
            50% {
                box-shadow: 0 0 25px var(--accent-yellow);
                border-color: var(--accent-yellow);
            }
            100% {
                box-shadow: 0 0 15px var(--accent-yellow);
                border-color: var(--accent-yellow);
            }
        }

        .best-match-indicator {
            background: linear-gradient(135deg, var(--accent-yellow), var(--accent-orange));
            color: var(--text-primary);
            text-align: center;
            padding: 5px;
            font-weight: bold;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            animation: glow 1.5s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from {
                text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px var(--accent-yellow);
            }
            to {
                text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px var(--accent-yellow);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: var(--primary-bg);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header-top {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: var(--accent-blue);
            border: none;
            border-radius: var(--border-radius);
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            font-size: 0.9rem;
        }

        .back-button:hover {
            background: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .back-button i {
            font-size: 1.1rem;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }

        .logo {
            height: 60px;
            margin-right: 15px;
            border-radius: 50%;
            box-shadow: var(--box-shadow);
        }

        .logo-text {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-yellow), var(--accent-purple));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .page-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        /* Tabs Navigation */
        .tabs-nav {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 12px 24px;
            background: var(--secondary-bg);
            border: none;
            border-radius: var(--border-radius);
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-button:hover {
            background: var(--card-hover);
            transform: translateY(-2px);
        }

        .tab-button.active {
            background: var(--accent-blue);
            box-shadow: 0 4px 12px rgba(78, 121, 230, 0.3);
        }

        .tab-button i {
            font-size: 1.1rem;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* League Colors */
        .league-battle-8m {
            border-left-color: var(--league-battle-8m);
        }

        .league-battle-volta-6m {
            border-left-color: var(--league-battle-volta-6m);
        }

        .league-gt-leagues-12m {
            border-left-color: var(--league-gt-leagues-12m);
        }

        .league-h2h-gg-8m {
            border-left-color: var(--league-h2h-gg-8m);
        }

        .league-adriatic-10m {
            border-left-color: var(--league-adriatic-10m);
        }

        .league-valhalla-cup {
            border-left-color: var(--accent-yellow);
        }

        .league-valkyrie-cup {
            border-left-color: var(--accent-cyan);
        }

        /* League Section */
        .league-section {
            margin-bottom: 30px;
        }

        .league-header {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: var(--secondary-bg);
            border-radius: var(--border-radius);
            margin-bottom: 15px;
            box-shadow: var(--box-shadow);
        }

        .league-icon {
            font-size: 1.5rem;
            margin-right: 12px;
            color: var(--accent-yellow);
        }

        .league-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            flex-grow: 1;
        }

        .league-matches-count {
            background: var(--accent-blue);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Matches Grid */
        .matches-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        /* Match Card */
        .match-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            border-left: 4px solid var(--accent-blue);
            position: relative;
            overflow: hidden;
        }

        /* Garantir que as cores das ligas sejam aplicadas corretamente */
        .match-card.league-battle-8m {
            border-left-color: var(--league-battle-8m);
        }

        .match-card.league-battle-volta-6m {
            border-left-color: var(--league-battle-volta-6m);
        }

        .match-card.league-gt-leagues-12m {
            border-left-color: var(--league-gt-leagues-12m);
        }

        .match-card.league-h2h-gg-8m {
            border-left-color: var(--league-h2h-gg-8m);
        }

        .match-card.league-adriatic-10m {
            border-left-color: var(--league-adriatic-10m);
        }

        .match-card.league-valhalla-cup {
            border-left-color: var(--accent-yellow);
        }

        .match-card.league-valkyrie-cup {
            border-left-color: var(--accent-cyan);
        }

        .match-card:hover {
            transform: translateY(-5px);
            background: var(--card-hover);
            box-shadow: 0 12px 28px rgba(0, 0, 0, 0.4);
        }

        .match-card.live {
            border-left-color: var(--accent-green);
        }

        .match-card.scheduled {
            border-left-color: var(--accent-red);
        }

        .match-card.finished {
            border-left-color: var(--accent-purple);
        }

        .match-card.goal-scored {
            animation: goalPulse 1.5s ease-out;
            border-left-width: 6px;
        }

        @keyframes goalPulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7);
            }

            50% {
                transform: scale(1.02);
                box-shadow: 0 0 0 10px rgba(255, 215, 0, 0);
            }

            100% {
                transform: scale(1);
            }
        }

        /* Anima√ß√µes espec√≠ficas para cada liga */
        .match-card.league-battle-8m.goal-scored {
            animation: goalPulseBattle8m 1.5s ease-out;
        }

        @keyframes goalPulseBattle8m {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 76, 76, 0.7);
            }

            50% {
                transform: scale(1.02);
                box-shadow: 0 0 0 10px rgba(255, 76, 76, 0);
            }

            100% {
                transform: scale(1);
            }
        }

        .match-card.league-battle-volta-6m.goal-scored {
            animation: goalPulseBattleVolta6m 1.5s ease-out;
        }

        @keyframes goalPulseBattleVolta6m {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7);
            }

            50% {
                transform: scale(1.02);
                box-shadow: 0 0 0 10px rgba(255, 215, 0, 0);
            }

            100% {
                transform: scale(1);
            }
        }

        .match-card.league-gt-leagues-12m.goal-scored {
            animation: goalPulseGTLeagues12m 1.5s ease-out;
        }

        @keyframes goalPulseGTLeagues12m {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(50, 205, 50, 0.7);
            }

            50% {
                transform: scale(1.02);
                box-shadow: 0 0 0 10px rgba(50, 205, 50, 0);
            }

            100% {
                transform: scale(1);
            }
        }

        .match-card.league-h2h-gg-8m.goal-scored {
            animation: goalPulseH2HGG8m 1.5s ease-out;
        }

        @keyframes goalPulseH2HGG8m {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(138, 43, 226, 0.7);
            }

            50% {
                transform: scale(1.02);
                box-shadow: 0 0 0 10px rgba(138, 43, 226, 0);
            }

            100% {
                transform: scale(1);
            }
        }

        .match-card.league-adriatic-10m.goal-scored {
            animation: goalPulseAdriatic10m 1.5s ease-out;
        }

        @keyframes goalPulseAdriatic10m {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(30, 144, 255, 0.7);
            }

            50% {
                transform: scale(1.02);
                box-shadow: 0 0 0 10px rgba(30, 144, 255, 0);
            }

            100% {
                transform: scale(1);
            }
        }

        .match-status {
            position: absolute;
            top: 0;
            right: 0;
            padding: 6px 12px;
            border-bottom-left-radius: var(--border-radius);
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-live {
            background: rgba(0, 204, 153, 0.2);
            color: var(--accent-green);
        }

        .status-scheduled {
            background: rgba(255, 107, 107, 0.2);
            color: var(--accent-red);
        }

        .status-finished {
            background: rgba(155, 89, 182, 0.2);
            color: var(--accent-purple);
        }

        .match-time {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .match-time i {
            font-size: 1rem;
        }

        .match-teams {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .team {
            flex: 1;
            text-align: center;
            padding: 0 10px;
        }

        .team-name {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .team-country {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 5px;
        }

        .team-player {
            font-size: 0.9rem;
            color: var(--accent-blue);
            font-weight: 500;
            margin-top: 3px;
        }

        .score-container {
            min-width: 80px;
            text-align: center;
            position: relative;
        }

        .score {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-primary);
            position: relative;
        }

        .score::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 2px;
            background: var(--accent-blue);
            opacity: 0.5;
        }

        .ht-score {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 8px;
            font-weight: 500;
        }

        .match-actions {
            display: flex;
            justify-content: center;
            margin-top: 15px;
        }

        .h2h-button {
            padding: 8px 20px;
            background: linear-gradient(135deg, var(--accent-purple), #c06c84);
            border: none;
            border-radius: 8px;
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .h2h-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(155, 89, 182, 0.3);
        }

        /* Finished Matches List */
        .finished-matches-list {
            display: grid;
            gap: 12px;
        }

        .finished-match {
            display: grid;
            grid-template-columns: 120px 1fr 80px 1fr;
            align-items: center;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 15px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            border-left: 4px solid var(--accent-blue);
        }

        /* Cores das ligas para jogos finalizados */
        .finished-match.league-battle-8m {
            border-left-color: var(--league-battle-8m);
        }

        .finished-match.league-battle-volta-6m {
            border-left-color: var(--league-battle-volta-6m);
        }

        .finished-match.league-gt-leagues-12m {
            border-left-color: var(--league-gt-leagues-12m);
        }

        .finished-match.league-h2h-gg-8m {
            border-left-color: var(--league-h2h-gg-8m);
        }

        .finished-match.league-adriatic-10m {
            border-left-color: var(--league-adriatic-10m);
        }

        .finished-match.league-valhalla-cup {
            border-left-color: var(--accent-yellow);
        }

        .finished-match.league-valkyrie-cup {
            border-left-color: var(--accent-cyan);
        }

        .finished-match:hover {
            background: var(--card-hover);
            transform: translateY(-3px);
        }

        .match-date {
            font-size: 0.85rem;
            color: var(--accent-yellow);
            font-weight: 500;
        }

        .match-league {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            grid-column: 1 / -1;
            margin-bottom: 5px;
            padding-bottom: 5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .finished-team {
            font-size: 0.95rem;
            font-weight: 500;
            padding: 0 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .finished-team.winner {
            color: var(--accent-green);
            font-weight: 600;
        }

        .finished-team .player {
            font-size: 0.8rem;
            color: var(--accent-blue);
            margin-top: 3px;
        }

        .finished-score {
            font-size: 1.2rem;
            font-weight: 700;
            text-align: center;
            position: relative;
        }

        .finished-score .ht-score {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            color: var(--text-muted);
            white-space: nowrap;
        }

        /* H2H Analysis */
        .h2h-container {
            background: var(--secondary-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
        }

        .h2h-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .h2h-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--accent-yellow), var(--accent-purple));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .players-comparison {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .player-name {
            font-size: 1.3rem;
            font-weight: 600;
            text-align: center;
            padding: 10px 20px;
            border-radius: var(--border-radius);
        }

        .player1-name {
            background: rgba(78, 121, 230, 0.2);
            color: var(--accent-blue);
        }

        .player2-name {
            background: rgba(155, 89, 182, 0.2);
            color: var(--accent-purple);
        }

        .vs-separator {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-muted);
        }

        .metric-tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
        }

        .metric-tab {
            padding: 10px 20px;
            background: var(--card-bg);
            border: none;
            border-radius: var(--border-radius);
            color: var(--text-primary);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .metric-tab:hover {
            background: var(--card-hover);
        }

        .metric-tab.active {
            background: var(--accent-green);
            color: white;
        }

        /* Stats Overview */
        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 15px;
            text-align: center;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Compact sizing for recent games analysis cards */
        .player-match-history .stats-overview {
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        .player-match-history .stat-card {
            padding: 10px;
        }
        .player-match-history .stat-card .stat-value {
            font-size: 1.4rem;
        }
        .player-match-history .stat-card .stat-label {
            font-size: 0.8rem;
        }

        .h2h-history-section .stats-overview {
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        .h2h-history-section .stat-card {
            padding: 10px;
        }
        .h2h-history-section .stat-card .stat-value {
            font-size: 1.4rem;
        }
        .h2h-history-section .stat-card .stat-label {
            font-size: 0.8rem;
        }

        /* Extra compact on small screens */
        @media (max-width: 768px) {
            .player-match-history .stats-overview,
            .h2h-history-section .stats-overview {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 8px;
            }
            .player-match-history .stat-card,
            .h2h-history-section .stat-card {
                padding: 8px;
            }
            .player-match-history .stat-card .stat-value,
            .h2h-history-section .stat-card .stat-value {
                font-size: 1.2rem;
            }
            .player-match-history .stat-card .stat-label,
            .h2h-history-section .stat-card .stat-label {
                font-size: 0.75rem;
            }
        }

        /* Metrics Grid */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 10px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s ease, background 0.2s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.08);
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
            opacity: 0.5;
        }

        .metric-label {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-bottom: 4px;
            display: block;
        }

        .metric-value {
            font-size: 1.2rem;
            font-weight: 700;
            display: block;
            margin-top: 2px;
        }

        /* Cores para diferentes faixas de porcentagem */
        .metric-value[data-value="high"] {
            color: var(--accent-green);
            text-shadow: 0 0 15px rgba(0, 204, 153, 0.3);
        }

        .metric-value[data-value="medium"] {
            color: var(--accent-yellow);
            text-shadow: 0 0 15px rgba(241, 196, 15, 0.3);
        }

        .metric-value[data-value="low"] {
            color: var(--accent-red);
            text-shadow: 0 0 15px rgba(255, 107, 107, 0.3);
        }

        .metric-card.high-probability {
            border: 2px solid var(--accent-green);
            box-shadow: 0 0 15px rgba(0, 204, 153, 0.3);
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: var(--metric-width, 0%);
            height: 100%;
            background: linear-gradient(to right, var(--accent-red), var(--accent-green));
            opacity: 0.3;
            z-index: 1;
            transition: width 0.5s ease;
        }

        .metric-name {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
            position: relative;
            z-index: 2;
        }

        .metric-value {
            font-size: 1.0rem;
            font-weight: 700;
            position: relative;
            z-index: 2;
        }

        /* Match History */
        .match-history-section, .h2h-history-section {
            margin-top: 30px;
        }

        .match-history-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
            color: var(--text-primary);
        }

        .match-history-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .player-match-history {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
        }

        .h2h-match-history {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            max-width: 600px;
            margin: 0 auto;
        }

        .history-match {
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: background 0.2s ease;
        }

        .history-match:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .history-match:last-child {
            border-bottom: none;
        }

        .history-match-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.85rem;
        }

        .match-date-history {
            color: var(--accent-yellow);
        }

        .match-league-history {
            color: var(--text-muted);
        }

        .history-teams {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .history-team {
            flex: 1;
            font-size: 0.95rem;
        }

        .history-team.winner {
            color: var(--accent-green);
            font-weight: 600;
        }

        .history-score {
            font-weight: 700;
            margin: 0 15px;
        }

        .history-ht {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-align: center;
        }

        /* Bet Suggestions */
        .bet-suggestions {
            margin-top: 30px;
            background: rgba(0, 204, 153, 0.1);
            border-radius: var(--border-radius);
            padding: 20px;
            border: 1px solid var(--accent-green);
        }

        .bet-suggestions-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--accent-green);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .bet-suggestions-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .bet-suggestion {
            background: rgba(0, 204, 153, 0.2);
            color: var(--accent-green);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* Loading and Error States */
        .loading-state {
            text-align: center;
            padding: 40px;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 0.6;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0.6;
            }
        }

        .error-state {
            text-align: center;
            padding: 20px;
            background: rgba(255, 107, 107, 0.1);
            border-radius: var(--border-radius);
            border: 1px solid var(--accent-red);
            color: var(--accent-red);
        }

        /* Back Button */
        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            background: var(--accent-yellow);
            border: none;
            border-radius: var(--border-radius);
            color: #000;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 20px;
        }

        .back-button:hover {
            background: #ffd700;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(241, 196, 15, 0.3);
        }

        /* Responsive Styles */
        @media (max-width: 1200px) {
            .matches-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }

        @media (max-width: 992px) {

            .match-history-grid {
                grid-template-columns: 1fr;
            }

            .finished-match {
                grid-template-columns: 100px 1fr 70px 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .logo {
                height: 50px;
            }

            .logo-text {
                font-size: 1.5rem;
            }

            .tab-button {
                padding: 10px 15px;
                font-size: 0.9rem;
            }

            .finished-match {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 10px;
            }

            .finished-team {
                padding: 5px 0;
            }

            .players-comparison {
                flex-direction: column;
                gap: 10px;
            }

            .metric-tabs {
                flex-wrap: wrap;
            }
        }

        @media (max-width: 576px) {
            .matches-grid {
                grid-template-columns: 1fr;
            }

            .metric-card {
                min-width: 100%;
            }
        }
    </style>
</head>

<body>
    <div class="container" id="app">
        <div class="header">
            <div class="header-top">
                <a href="index.html" class="back-button">
                    <i class="fas fa-arrow-left"></i>
                    Voltar
                </a>
                <div></div> <!-- Espa√ßador para manter o alinhamento central -->
            </div>
            <div class="logo-container">
                <img src="https://i.ibb.co/G4Y8sHM/Chat-GPT-Image-21-de-abr-de-2025-16-14-34-1.png" alt="RW Tips Logo"
                    class="logo">
                <h2 class="logo-text">üëë ùó•ùó™ ùóßùóúùó£ùó¶ üéÆ</h2>
            </div>
            <h2 class="page-title">eSoccer</h2>
        </div>

        <nav class="tabs-nav">
            <button class="tab-button active" onclick="openTab('live')">
                <i class="fas fa-tv"></i> Ao Vivo
            </button>
            <button class="tab-button" onclick="openTab('finished')">
                <i class="fas fa-history"></i> Finalizados
            </button>
            <button class="tab-button" onclick="openTab('h2h')">
                <i class="fas fa-chart-line"></i> An√°lise H2H
            </button>
        </nav>

        <!-- Live Matches Tab -->
        <div id="live-tab" class="tab-content active">
            <div id="loading-live" class="loading-state">
                <i class="fas fa-spinner fa-spin"></i> Carregando jogos ao vivo...
            </div>
            <div id="error-live" class="error-state" style="display: none;"></div>
            <div id="matches-live-content"></div>
        </div>

        <!-- Finished Matches Tab -->
        <div id="finished-tab" class="tab-content">
            <div id="loading-finished" class="loading-state">
                <i class="fas fa-spinner fa-spin"></i> Carregando jogos finalizados...
            </div>
            <div id="error-finished" class="error-state" style="display: none;"></div>
            <div id="matches-finished-content" class="finished-matches-list"></div>
        </div>

        <!-- H2H Analysis Tab -->
        <div id="h2h-tab" class="tab-content">
            <div id="loading-h2h" class="loading-state">
                <i class="fas fa-spinner fa-spin"></i> Carregando an√°lises H2H...
            </div>
            <div id="error-h2h" class="error-state" style="display: none;"></div>
            <div id="h2h-content" class="h2h-container" style="display: none;">
                <div class="h2h-header">
                    <h2 class="h2h-title">An√°lise Confronto Direto</h2>
                    <div class="players-comparison" id="players-comparison"></div>
                </div>

                <div class="metric-tabs">
                    <button class="metric-tab active" onclick="showMetrics('5')">√öltimos 5 Jogos</button>
                    <button class="metric-tab" onclick="showMetrics('10')">√öltimos 10 Jogos</button>
                </div>

                <div class="stats-overview" id="h2h-overview"></div>

                <div class="metrics-grid" id="h2h-metrics"></div>

                <div class="bet-suggestions" id="bet-suggestions" style="display: none;">
                    <h3 class="bet-suggestions-title">
                        <i class="fas fa-lightbulb"></i> Palpites com Alta Probabilidade
                    </h3>
                    <div class="bet-suggestions-list" id="bet-suggestions-list"></div>
                </div>

                <div class="h2h-history-section">
                    <h3 class="match-history-title">Hist√≥rico de Confrontos Diretos</h3>
                    <div class="stats-overview" id="h2h-summary"></div>
                    <div class="h2h-match-history" id="h2h-matches"></div>
                </div>

                <div class="match-history-section">
                    <h3 class="match-history-title">Hist√≥rico Individual de Partidas</h3>
                    <div class="match-history-grid">
                        <div class="player-match-history">
                            <h4 class="player-stat-header player1-stat-header" id="player1-history-header">√öltimas
                                Partidas</h4>
                            <div class="stats-overview" id="player1-summary"></div>
                            <div id="player1-matches"></div>
                        </div>
                        <div class="player-match-history">
                            <h4 class="player-stat-header player2-stat-header" id="player2-history-header">√öltimas
                                Partidas</h4>
                            <div class="stats-overview" id="player2-summary"></div>
                            <div id="player2-matches"></div>
                        </div>
                    </div>
                </div>

                <button class="back-button" onclick="goBack()">
                    <i class="fas fa-arrow-left"></i> Voltar
                </button>
            </div>
        </div>
    </div>

    <script>
        if (sessionStorage.getItem('loggedIn') !== 'true') {
            window.location.href = 'index.html?error=login_required';
        }
        const API_URL_LIVE = 'https://caveira-proxy.onrender.com/api/matches/live';
        const API_URL_FINISHED = 'https://caveira-proxy.onrender.com/api/historico/partidas';
        const API_URL_PLAYER_HISTORY = 'https://caveira-proxy.onrender.com/api/v1/historico/partidas-assincrono';
        const API_URL_H2H = 'https://caveira-proxy.onrender.com/api/v1/historico/confronto';

        let previousScores = new Map();
        let liveUpdateInterval = null;
        let h2hData = null;
        let currentPlayer1 = '';
        let currentPlayer2 = '';

        function formatTime(minutes, seconds) {
            return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        function calculateRemainingTime(tm, ts) {
            const totalSeconds = tm * 60;
            const remainingSeconds = Math.max(0, totalSeconds - ts);
            const minutes = Math.floor(remainingSeconds / 60);
            const seconds = remainingSeconds % 60;
            return {
                formatted: formatTime(minutes, seconds)
            };
        }

        function formatDateTime(dateInput) {
            let date;
            if (typeof dateInput === 'string' && dateInput.includes('T')) {
                date = new Date(dateInput);
            } else if (!isNaN(dateInput)) {
                date = new Date(dateInput * 1000);
            } else {
                return 'Data inv√°lida';
            }

            if (isNaN(date.getTime())) {
                return 'Data inv√°lida';
            }

            const options = {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                timeZone: 'America/Sao_Paulo'
            };

            return date.toLocaleString('pt-BR', options);
        }

        function groupMatchesByLeague(matches) {
            const leagues = {};
            matches.forEach(match => {
                const leagueName = match.league?.name || match.league_name;
                if (!leagues[leagueName]) leagues[leagueName] = [];
                leagues[leagueName].push(match);
            });
            return leagues;
        }

        function getLeagueClass(leagueName) {
            const leagueClasses = {
                "Esoccer Battle - 8 mins play": "battle-8m",
                "Esoccer Battle Volta - 6 mins play": "battle-volta-6m",
                "Esoccer GT Leagues ‚Äì 12 mins play": "gt-leagues-12m",
                "Esoccer H2H GG League - 8 mins play": "h2h-gg-8m",
                "Esoccer Adriatic League - 10 mins play": "adriatic-10m",
                "Valhalla Cup": "valhalla-cup",
                "Valkyrie Cup": "valkyrie-cup"
            };
            return leagueClasses[leagueName] || '';
        }

        function isGameScheduled(match) {
            return match.time_status === "0";
        }

        function isGameLive(match) {
            return match.time_status === "1";
        }

        function isGameFinished(match) {
            return match.time_status === "3";
        }

        function isGameNotStartedYet(match) {
            if (match.time_status === "0") {
                const gameTime = new Date(match.time * 1000);
                const currentTime = new Date();
                return currentTime < gameTime;
            }
            return false;
        }

        function parseScore(ss) {
            if (!ss) return { home: 0, away: 0 };
            const [home, away] = ss.split('-').map(score => parseInt(score.trim()) || 0);
            return { home, away };
        }

        function parseHTScore(match) {
            if (match.stats && match.stats.ht_score) {
                const [home, away] = match.stats.ht_score.split('-').map(score => parseInt(score.trim()) || 0);
                return { home, away };
            } else if (match.halftime_score_home !== undefined && match.halftime_score_away !== undefined) {
                return { home: match.halftime_score_home, away: match.halftime_score_away };
            }
            return { home: 0, away: 0 };
        }

        function extractPlayerName(teamName) {
            if (!teamName) return 'Desconhecido';
            const match = teamName.match(/\(([^)]+)\)/);
            return match ? match[1] : teamName;
        }

        let bestMatchups = {
            battle8m: [], 
            battle6m: [], 
            gt12m: []    
        };

        async function updateBestMatchups() {
            try {
                const response = await fetch('https://caveira-proxy.onrender.com/api/dashboard/data');
                const data = await response.json();
                console.log('Dados recebidos da API:', data);
                
                bestMatchups.battle8m = [];
                bestMatchups.battle6m = [];
                bestMatchups.gt12m = [];
                
                if (data.strategyResults && data.strategyResults.overBattle) {
                    bestMatchups.battle8m = data.strategyResults.overBattle
                        .filter(match => match.combinedPercentage >= 100)
                        .map(match => ({
                            player1: match.homePlayer,
                            player2: match.awayPlayer
                        }));
                }
                
                if (data.strategyResults && data.strategyResults.voltaOver) {
                    bestMatchups.battle6m = data.strategyResults.voltaOver
                        .filter(match => match.combinedPercentage >= 100)
                        .map(match => ({
                            player1: match.homePlayer,
                            player2: match.awayPlayer
                        }));
                }
                
                if (data.strategyResults && data.strategyResults.gtOverHt) {
                    bestMatchups.gt12m = data.strategyResults.gtOverHt
                        .filter(match => match.combinedPercentage >= 100)
                        .map(match => ({
                            player1: match.homePlayer,
                            player2: match.awayPlayer
                        }));
                }
                
                console.log('Melhores confrontos atualizados:', bestMatchups);
            } catch (error) {
                console.error('Erro ao atualizar melhores confrontos:', error);
            }
        }

        function isBestMatchup(homePlayer, awayPlayer, leagueName) {
            let matchupList = [];
            console.log('Verificando liga:', leagueName);
            if (leagueName.toLowerCase().includes('battle') && !leagueName.toLowerCase().includes('volta') && leagueName.includes('8 mins')) {
                matchupList = bestMatchups.battle8m;
                console.log('Liga 8m:', matchupList);
            } else if (leagueName.toLowerCase().includes('volta') && leagueName.includes('6 mins')) {
                matchupList = bestMatchups.battle6m;
                console.log('Liga 6m:', matchupList);
            } else if (leagueName.toLowerCase().includes('gt') && leagueName.includes('12 mins')) {
                matchupList = bestMatchups.gt12m;
                console.log('Liga 12m:', matchupList);
            }
            console.log('Verificando jogadores:', homePlayer, awayPlayer);

            const isMatch = matchupList.some(match => {
                const p1 = match.player1.toLowerCase();
                const p2 = match.player2.toLowerCase();
                const home = homePlayer.toLowerCase();
                const away = awayPlayer.toLowerCase();
                return (p1 === home && p2 === away) || (p1 === away && p2 === home);
            });
            console.log('√â melhor confronto?', isMatch);
            return isMatch;
        }

        setInterval(updateBestMatchups, 5 * 60 * 1000);
        updateBestMatchups();

        function renderLiveMatches(data) {
            console.log('Dados recebidos para jogos ao vivo:', data);
            if (!data || !data.data || !Array.isArray(data.data) || data.data.length === 0) {
                document.getElementById('loading-live').style.display = 'none';
                document.getElementById('error-live').textContent = 'Nenhum jogo ao vivo encontrado no momento.';
                document.getElementById('error-live').style.display = 'block';
                return;
            }

            const matchesContent = document.getElementById('matches-live-content');
            matchesContent.innerHTML = '';

            const leagues = groupMatchesByLeague(data.data);

            for (const leagueName in leagues) {
                const matches = leagues[leagueName];
                const leagueClass = getLeagueClass(leagueName);

                const leagueSection = document.createElement('div');
                leagueSection.className = 'league-section';

                const leagueHeader = document.createElement('div');
                leagueHeader.className = 'league-header';
                leagueHeader.innerHTML = `
                    <i class="fas fa-trophy league-icon"></i>
                    <h3 class="league-name">${leagueName}</h3>
                    <span class="league-matches-count">${matches.length} jogos</span>
                `;
                leagueSection.appendChild(leagueHeader);

                const matchesGrid = document.createElement('div');
                matchesGrid.className = 'matches-grid';

                matches.forEach(match => {
                    const gameScheduled = isGameScheduled(match);
                    const gameLive = isGameLive(match);
                    const gameFinished = isGameFinished(match);
                    const gameNotStartedYet = isGameNotStartedYet(match);

                    let statusClass = 'scheduled';
                    let statusText = 'AGENDADO';
                    let timeDisplay = formatDateTime(match.time);
                    let timeIcon = 'far fa-clock';

                    if (gameLive) {
                        statusClass = 'live';
                        statusText = 'AO VIVO';
                        const timeCalc = calculateRemainingTime(match.timer.tm, match.timer.ts);
                        timeDisplay = timeCalc.formatted;
                        timeIcon = 'fas fa-play';
                    } else if (gameFinished) {
                        statusClass = 'finished';
                        statusText = 'FINALIZADO';
                        timeIcon = 'fas fa-check-circle';
                    } else if (gameNotStartedYet) {
                        statusClass = 'scheduled';
                        statusText = 'AGENDADO';
                        timeIcon = 'far fa-clock';
                    } else if (gameScheduled) {
                        if (match.timer && match.timer.tm === 0 && match.timer.ts === 0) {
                            statusClass = 'scheduled';
                            statusText = 'AGENDADO';
                            timeIcon = 'far fa-clock';
                        } else {
                            statusClass = 'finished';
                            statusText = 'FINALIZADO';
                            timeIcon = 'fas fa-check-circle';
                        }
                    }

                    const { home: scoreHome, away: scoreAway } = parseScore(match.ss);
                    const { home: htHome, away: htAway } = parseHTScore(match);

                    const matchId = match.id || `${match.home.name}-${match.away.name}-${match.time}`;
                    const previousScore = previousScores.get(matchId);
                    const scoreChanged = previousScore && (previousScore.home !== scoreHome || previousScore.away !== scoreAway);
                    previousScores.set(matchId, { home: scoreHome, away: scoreAway });

                    const homePlayer = extractPlayerName(match.home.name);
                    const awayPlayer = extractPlayerName(match.away.name);
                    const homeTeam = match.home.name ? match.home.name.split('(')[0].trim() : '';
                    const awayTeam = match.away.name ? match.away.name.split('(')[0].trim() : '';

                    const matchCard = document.createElement('div');
                    const isBestMatch = isBestMatchup(homePlayer, awayPlayer, leagueName);
                    matchCard.className = `match-card league-${leagueClass} ${scoreChanged ? 'goal-scored' : ''} ${isBestMatch ? 'best-matchup' : ''}`;
                    
                    if (isBestMatch) {
                        matchCard.style.boxShadow = '0 0 15px var(--accent-yellow)';
                        matchCard.style.border = '2px solid var(--accent-yellow)';
                        matchCard.style.animation = 'bestMatchPulse 2s infinite';
                    }

                    matchCard.innerHTML = `
                        ${isBestMatch ? '<div class="best-match-indicator">‚≠ê TOP MATCH ‚≠ê</div>' : ''}
                        <div class="match-status status-${statusClass}">${statusText}</div>
                        <div class="match-time">
                            <i class="${timeIcon}"></i> ${timeDisplay}
                        </div>
                        <div class="match-teams">
                            <div class="team">
                                <div class="team-name">
                                    ${homeTeam}
                                    <span class="team-player">${homePlayer}</span>
                                </div>
                            </div>
                            <div class="score-container">
                                <div class="score">${scoreHome}-${scoreAway}</div>
                                ${(htHome || htAway) ? `<div class="ht-score">HT: ${htHome}-${htAway}</div>` : ''}
                            </div>
                            <div class="team">
                                <div class="team-name">
                                    ${awayTeam}
                                    <span class="team-player">${awayPlayer}</span>
                                </div>
                            </div>
                        </div>
                        <div class="match-actions">
                            <button class="h2h-button" onclick="openH2H('${homePlayer}', '${awayPlayer}')">
                                <i class="fas fa-chart-line"></i> An√°lise H2H
                            </button>
                        </div>
                    `;

                    matchesGrid.appendChild(matchCard);
                });

                leagueSection.appendChild(matchesGrid);
                matchesContent.appendChild(leagueSection);
            }

            document.getElementById('loading-live').style.display = 'none';
            document.title = `RW TIPS - eSoccer (${data.data.length} jogos ao vivo)`;
        }

        function renderFinishedMatches(data) {
            console.log('Dados recebidos para jogos finalizados:', data);
            if (!data || !data.partidas || !Array.isArray(data.partidas) || data.partidas.length === 0) {
                document.getElementById('loading-finished').style.display = 'none';
                document.getElementById('error-finished').textContent = 'Nenhum jogo finalizado encontrado.';
                document.getElementById('error-finished').style.display = 'block';
                return;
            }

            const matchesContent = document.getElementById('matches-finished-content');
            matchesContent.innerHTML = '';

            data.partidas.forEach(match => {
                const leagueClass = getLeagueClass(match.league_name);
                const { home: htHome, away: htAway } = parseHTScore(match);
                const scoreHome = match.score_home || 0;
                const scoreAway = match.score_away || 0;
                const winnerHome = scoreHome > scoreAway;
                const winnerAway = scoreAway > scoreHome;

                const finishedMatch = document.createElement('div');
                finishedMatch.className = `finished-match league-${leagueClass}`;

                finishedMatch.innerHTML = `
                    <div class="match-league ${leagueClass}">${match.league_name}</div>
                    <div class="match-date">${formatDateTime(match.data_realizacao)}</div>
                    <div class="finished-team ${winnerHome ? 'winner' : ''}">
                        ${match.home_team}
                        <div class="player">${match.home_player}</div>
                    </div>
                    <div class="finished-score">
                        ${scoreHome} x ${scoreAway}
                        ${(htHome || htAway) ? `<div class="ht-score">HT: ${htHome}-${htAway}</div>` : ''}
                    </div>
                    <div class="finished-team ${winnerAway ? 'winner' : ''}">
                        ${match.away_team}
                        <div class="player">${match.away_player}</div>
                    </div>
                `;

                matchesContent.appendChild(finishedMatch);
            });

            document.getElementById('loading-finished').style.display = 'none';
            document.title = `RW TIPS - eSoccer (${data.partidas.length} jogos finalizados)`;
        }

        async function fetchLiveMatches() {
            try {
                document.getElementById('error-live').style.display = 'none';
                if (!window.initialLoad) document.getElementById('loading-live').style.display = 'block';

                const response = await fetch(API_URL_LIVE, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Erro na API: ${response.status} ${response.statusText}. Detalhes: ${errorText}`);
                }

                const data = await response.json();
                renderLiveMatches(data);
            } catch (error) {
                console.error('Erro ao buscar jogos ao vivo:', error);
                document.getElementById('loading-live').style.display = 'none';
                document.getElementById('error-live').textContent = `Erro ao carregar jogos ao vivo: ${error.message}`;
                document.getElementById('error-live').style.display = 'block';
            }
        }

        async function fetchFinishedMatches() {
            try {
                document.getElementById('error-finished').style.display = 'none';
                document.getElementById('loading-finished').style.display = 'block';

                const response = await fetch(API_URL_FINISHED, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Erro na API: ${response.status} ${response.statusText}. Detalhes: ${errorText}`);
                }

                const data = await response.json();
                renderFinishedMatches(data);
            } catch (error) {
                console.error('Erro ao buscar jogos finalizados:', error);
                document.getElementById('loading-finished').style.display = 'none';
                document.getElementById('error-finished').textContent = `Erro ao carregar jogos finalizados: ${error.message}`;
                document.getElementById('error-finished').style.display = 'block';
            }
        }

        async function fetchPlayerHistory(player, limit) {
            try {
                const url = `${API_URL_PLAYER_HISTORY}?jogador=${encodeURIComponent(player)}&limit=${limit}&page=1`;
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Erro na API: ${response.status} ${response.statusText}. Detalhes: ${errorText}`);
                }

                const data = await response.json();
                return data.partidas || [];
            } catch (error) {
                console.error(`Erro ao buscar hist√≥rico do jogador ${player}:`, error);
                throw error;
            }
        }

        async function fetchH2HMatches(player1, player2, limit = 20) {
            try {
                const url = `${API_URL_H2H}/${encodeURIComponent(player1)}/${encodeURIComponent(player2)}?page=1&limit=${limit}`;
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Erro na API: ${response.status} ${response.statusText}. Detalhes: ${errorText}`);
                }

                const data = await response.json();
                return data;
            } catch (error) {
                console.error(`Erro ao buscar confrontos H2H entre ${player1} e ${player2}:`, error);
                throw error;
            }
        }

        function calculateH2HMetrics(matches, limit) {
            if (!matches || matches.length === 0) {
                return {
                    over05_ht: 0,
                    over15_ht: 0,
                    over25_ht: 0,
                    btts_ht: 0,
                    over05_ft: 0,
                    over15_ft: 0,
                    over25_ft: 0,
                    btts_ft: 0,
                    media_gols_ht: 0,
                    media_gols_ft: 0
                };
            }

            const selectedMatches = matches.slice(0, limit);
            const totalMatches = selectedMatches.length;

            let over05HT = 0, over15HT = 0, over25HT = 0, bttsHT = 0;
            let over05FT = 0, over15FT = 0, over25FT = 0, bttsFT = 0;
            let totalGoalsHT = 0, totalGoalsFT = 0;

            selectedMatches.forEach(match => {
                const scoreHomeHT = match.halftime_score_home || 0;
                const scoreAwayHT = match.halftime_score_away || 0;
                const scoreHomeFT = match.score_home || 0;
                const scoreAwayFT = match.score_away || 0;

                const goalsHT = scoreHomeHT + scoreAwayHT;
                if (goalsHT > 0) over05HT++;
                if (goalsHT > 1.5) over15HT++;
                if (goalsHT > 2.5) over25HT++;
                if (scoreHomeHT > 0 && scoreAwayHT > 0) bttsHT++;
                totalGoalsHT += goalsHT;

                const goalsFT = scoreHomeFT + scoreAwayFT;
                if (goalsFT > 0) over05FT++;
                if (goalsFT > 1.5) over15FT++;
                if (goalsFT > 2.5) over25FT++;
                if (scoreHomeFT > 0 && scoreAwayFT > 0) bttsFT++;
                totalGoalsFT += goalsFT;
            });

            return {
                over05_ht: (over05HT / totalMatches) * 100,
                over15_ht: (over15HT / totalMatches) * 100,
                over25_ht: (over25HT / totalMatches) * 100,
                btts_ht: (bttsHT / totalMatches) * 100,
                over05_ft: (over05FT / totalMatches) * 100,
                over15_ft: (over15FT / totalMatches) * 100,
                over25_ft: (over25FT / totalMatches) * 100,
                btts_ft: (bttsFT / totalMatches) * 100,
                media_gols_ht: totalGoalsHT / totalMatches,
                media_gols_ft: totalGoalsFT / totalMatches
            };
        }

        function calculateH2HSummary(matches) {
            let player1Wins = 0, player2Wins = 0, draws = 0, zeroZero = 0, btts = 0;
            matches.forEach(match => {
                const sh = match.score_home || 0;
                const sa = match.score_away || 0;
                let winnerPlayer;
                if (sh > sa) winnerPlayer = match.home_player;
                else if (sa > sh) winnerPlayer = match.away_player;
                else {
                    draws++;
                    if (sh === 0 && sa === 0) zeroZero++;
                }
                if (winnerPlayer === currentPlayer1) player1Wins++;
                else if (winnerPlayer === currentPlayer2) player2Wins++;
                if (sh > 0 && sa > 0) btts++;
            });
            return { player1Wins, player2Wins, draws, zeroZero, btts, total: matches.length };
        }

        function calculatePlayerSummary(matches, player) {
            let wins = 0, losses = 0, draws = 0, zeroZero = 0, btts = 0;
            matches.forEach(match => {
                const isHome = match.home_player === player;
                const myScore = isHome ? match.score_home || 0 : match.score_away || 0;
                const oppScore = isHome ? match.score_away || 0 : match.score_home || 0;
                if (myScore > oppScore) wins++;
                else if (myScore < oppScore) losses++;
                else {
                    draws++;
                    if (myScore === 0 && oppScore === 0) zeroZero++;
                }
                if (myScore > 0 && oppScore > 0) btts++;
            });
            return { wins, losses, draws, zeroZero, btts, total: matches.length };
        }

        function generateBetSuggestions(metrics) {
            const suggestions = [];

            if (metrics.over05_ht >= 91) suggestions.push('Over 0.5 HT');
            if (metrics.over15_ht >= 91) suggestions.push('Over 1.5 HT');
            if (metrics.over25_ht >= 91) suggestions.push('Over 2.5 HT');
            if (metrics.btts_ht >= 91) suggestions.push('Ambas marcam HT');
            if (metrics.over05_ft >= 91) suggestions.push('Over 0.5 FT');
            if (metrics.over15_ft >= 91) suggestions.push('Over 1.5 FT');
            if (metrics.over25_ft >= 91) suggestions.push('Over 2.5 FT');
            if (metrics.btts_ft >= 91) suggestions.push('Ambas marcam FT');

            return suggestions;
        }

        async function fetchH2HData(player1, player2) {
            try {
                document.getElementById('loading-h2h').style.display = 'block';
                document.getElementById('error-h2h').style.display = 'none';
                document.getElementById('h2h-content').style.display = 'none';

                const [last5Player1, last5Player2, last10Player1, last10Player2, h2hMatches] = await Promise.all([
                    fetchPlayerHistory(player1, 5),
                    fetchPlayerHistory(player2, 5),
                    fetchPlayerHistory(player1, 10),
                    fetchPlayerHistory(player2, 10),
                    fetchH2HMatches(player1, player2, 20)
                ]);

                const h2hMetrics5 = calculateH2HMetrics(h2hMatches.matches, 5);
                const h2hMetrics10 = calculateH2HMetrics(h2hMatches.matches, 10);

                h2hData = {
                    h2h_stats: {
                        total_matches: h2hMatches.total_matches,
                        player1_wins: h2hMatches.player1_wins,
                        player2_wins: h2hMatches.player2_wins,
                        draws: h2hMatches.draws,
                        player1_win_percentage: h2hMatches.player1_win_percentage,
                        player2_win_percentage: h2hMatches.player2_win_percentage,
                        draw_percentage: h2hMatches.draw_percentage,
                        matches: h2hMatches.matches
                    },
                    ultimos_5: {
                        [player1]: { matches: last5Player1 },
                        [player2]: { matches: last5Player2 },
                        h2h_metrics: h2hMetrics5
                    },
                    ultimos_10: {
                        [player1]: { matches: last10Player1 },
                        [player2]: { matches: last10Player2 },
                        h2h_metrics: h2hMetrics10
                    }
                };

                currentPlayer1 = player1;
                currentPlayer2 = player2;

                document.getElementById('player1-history-header').textContent = `√öltimas partidas do ${player1}`;
                document.getElementById('player2-history-header').textContent = `√öltimas partidas do ${player2}`;

                showMetrics('5');
            } catch (error) {
                console.error('Erro ao buscar dados H2H:', error);
                document.getElementById('loading-h2h').style.display = 'none';
                document.getElementById('error-h2h').textContent = `Erro ao carregar an√°lises H2H: ${error.message}`;
                document.getElementById('error-h2h').style.display = 'block';
            }
        }

        function showMetrics(period) {
            const h2hOverview = document.getElementById('h2h-overview');
            const h2hMetrics = document.getElementById('h2h-metrics');
            const player1Matches = document.getElementById('player1-matches');
            const player2Matches = document.getElementById('player2-matches');
            const h2hMatchesElem = document.getElementById('h2h-matches');
            const betSuggestions = document.getElementById('bet-suggestions');
            const betSuggestionsList = document.getElementById('bet-suggestions-list');
            const h2hSummaryElem = document.getElementById('h2h-summary');
            const player1SummaryElem = document.getElementById('player1-summary');
            const player2SummaryElem = document.getElementById('player2-summary');
            const playersComparison = document.getElementById('players-comparison');

            h2hOverview.innerHTML = '';
            h2hMetrics.innerHTML = '';
            player1Matches.innerHTML = '';
            player2Matches.innerHTML = '';
            h2hMatchesElem.innerHTML = '';
            betSuggestionsList.innerHTML = '';
            h2hSummaryElem.innerHTML = '';
            player1SummaryElem.innerHTML = '';
            player2SummaryElem.innerHTML = '';
            playersComparison.innerHTML = '';

            if (!h2hData || !h2hData[`ultimos_${period}`]) {
                return;
            }

            const data = h2hData[`ultimos_${period}`];
            const h2hStats = h2hData.h2h_stats;

            // Highlight the better player
            const isPlayer1Better = h2hStats.player1_win_percentage > h2hStats.player2_win_percentage;
            playersComparison.innerHTML = `
                <div class="player-name player1-name ${isPlayer1Better ? 'highlighted' : ''}" id="player1-name-summary">${currentPlayer1}</div>
                <div class="vs-separator">VS</div>
                <div class="player-name player2-name ${!isPlayer1Better && h2hStats.player2_win_percentage > h2hStats.player1_win_percentage ? 'highlighted' : ''}" id="player2-name-summary">${currentPlayer2}</div>
            `;

            // Update overview stats
            h2hOverview.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${h2hStats.total_matches}</div>
                    <div class="stat-label">Confrontos totais</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${h2hStats.player1_win_percentage.toFixed(0)}%</div>
                    <div class="stat-label">Vit√≥rias ${currentPlayer1}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${h2hStats.player2_win_percentage.toFixed(0)}%</div>
                    <div class="stat-label">Vit√≥rias ${currentPlayer2}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${h2hStats.draw_percentage.toFixed(0)}%</div>
                    <div class="stat-label">Empates</div>
                </div>
            `;

            // Update H2H metrics
            const h2hMetricsData = data.h2h_metrics;
            const h2hMetricsList = [
                { name: 'Over 0.5 HT', value: h2hMetricsData.over05_ht, isAverage: false },
                { name: 'Over 1.5 HT', value: h2hMetricsData.over15_ht, isAverage: false },
                { name: 'Over 2.5 HT', value: h2hMetricsData.over25_ht, isAverage: false },
                { name: 'BTTS HT', value: h2hMetricsData.btts_ht, isAverage: false },
                { name: 'M√©dia Gols HT', value: h2hMetricsData.media_gols_ht, isAverage: true },
                { name: 'Over 0.5 FT', value: h2hMetricsData.over05_ft, isAverage: false },
                { name: 'Over 1.5 FT', value: h2hMetricsData.over15_ft, isAverage: false },
                { name: 'Over 2.5 FT', value: h2hMetricsData.over25_ft, isAverage: false },
                { name: 'BTTS FT', value: h2hMetricsData.btts_ft, isAverage: false },
                { name: 'M√©dia Gols FT', value: h2hMetricsData.media_gols_ft, isAverage: true }
            ];

            h2hMetrics.innerHTML = h2hMetricsList.map(metric => {
                const valueNum = metric.isAverage ? metric.value : Math.round(metric.value);
                const valueFormatted = metric.isAverage ? valueNum.toFixed(1) : valueNum + '%';
                const valueClass = metric.isAverage ? (valueNum >= 2.5 ? 'high' : valueNum >= 1.5 ? 'medium' : 'low') : (metric.value >= 70 ? 'high' : metric.value >= 40 ? 'medium' : 'low');
                const isHighProbability = !metric.isAverage && metric.value >= 91;
                const metricWidth = metric.isAverage ? Math.min(valueNum * 20, 100) : valueNum;
                return `
                    <div class="metric-card ${isHighProbability ? 'high-probability' : ''}" style="--metric-width: ${metricWidth}%">
                        <div class="metric-name">${metric.name}</div>
                        <div class="metric-value" data-value="${valueClass}">${valueFormatted}</div>
                    </div>
                `;
            }).join('');

            // Generate bet suggestions
            const suggestions = generateBetSuggestions(h2hMetricsData);
            if (suggestions.length > 0) {
                betSuggestions.style.display = 'block';
                suggestions.forEach(suggestion => {
                    const suggestionItem = document.createElement('div');
                    suggestionItem.className = 'bet-suggestion';
                    suggestionItem.textContent = suggestion;
                    betSuggestionsList.appendChild(suggestionItem);
                });
            } else {
                betSuggestions.style.display = 'none';
            }

            // Update individual player matches
            const player1MatchesData = data[currentPlayer1]?.matches || [];
            const player2MatchesData = data[currentPlayer2]?.matches || [];

            const createMatchItem = (match, isHome, currentPlayer) => {
                const { home: htHome, away: htAway } = parseHTScore(match);
                const scoreHome = match.score_home || 0;
                const scoreAway = match.score_away || 0;
                const myScore = isHome ? scoreHome : scoreAway;
                const oppScore = isHome ? scoreAway : scoreHome;
                const winnerMy = myScore > oppScore;
                const winnerOpp = myScore < oppScore;
                const teamPlayer = isHome ? `${match.home_player} (${match.home_team})` : `${match.away_player} (${match.away_team})`;
                const opponent = isHome ? `${match.away_player} (${match.away_team})` : `${match.home_player} (${match.home_team})`;
                const scoreFT = `${myScore} x ${oppScore}`;
                const htLeft = isHome ? htHome : htAway;
                const htRight = isHome ? htAway : htHome;
                const scoreHT = (htLeft || htRight) ? `HT: ${htLeft}-${htRight}` : '';

                const matchItem = document.createElement('div');
                matchItem.className = 'history-match';
                matchItem.style.display = 'grid';
                matchItem.style.gridTemplateColumns = '1fr 80px 1fr';
                matchItem.style.alignItems = 'center';
                matchItem.style.padding = '8px 0';
                matchItem.style.borderBottom = '1px solid var(--text-muted)';

                const leftDiv = document.createElement('div');
                leftDiv.className = `history-team ${winnerMy ? 'winner' : ''}`;
                leftDiv.textContent = teamPlayer;
                leftDiv.style.textAlign = 'left';

                const centerDiv = document.createElement('div');
                centerDiv.className = 'history-score';
                centerDiv.textContent = scoreFT;
                centerDiv.style.textAlign = 'center';
                centerDiv.style.fontWeight = '700';

                const rightDiv = document.createElement('div');
                rightDiv.className = `history-team ${winnerOpp ? 'winner' : ''}`;
                rightDiv.textContent = opponent;
                rightDiv.style.textAlign = 'right';

                matchItem.appendChild(leftDiv);
                matchItem.appendChild(centerDiv);
                matchItem.appendChild(rightDiv);

                if (scoreHT) {
                    const htDiv = document.createElement('div');
                    htDiv.className = 'history-ht';
                    htDiv.textContent = scoreHT;
                    htDiv.style.gridColumn = '1 / -1';
                    htDiv.style.textAlign = 'center';
                    htDiv.style.color = 'var(--text-muted)';
                    htDiv.style.fontSize = '0.8rem';
                    htDiv.style.marginTop = '4px';
                    matchItem.appendChild(htDiv);
                }

                return matchItem;
            };

            player1MatchesData.forEach(match => {
                const isHome = match.home_player === currentPlayer1;
                const matchItem = createMatchItem(match, isHome, currentPlayer1);
                player1Matches.appendChild(matchItem);
            });

            player2MatchesData.forEach(match => {
                const isHome = match.home_player === currentPlayer2;
                const matchItem = createMatchItem(match, isHome, currentPlayer2);
                player2Matches.appendChild(matchItem);
            });

            // Update H2H matches history
            const h2hMatchesData = h2hData.h2h_stats.matches.slice(0, period == '5' ? 5 : 10);

            const createH2HMatchItem = (match) => {
                const isPlayer1Home = match.home_player === currentPlayer1;
                const leftPlayer = currentPlayer1 + ` (${isPlayer1Home ? match.home_team : match.away_team})`;
                const rightPlayer = currentPlayer2 + ` (${isPlayer1Home ? match.away_team : match.home_team})`;
                const leftScore = isPlayer1Home ? match.score_home : match.score_away;
                const rightScore = isPlayer1Home ? match.score_away : match.score_home;
                const { home: htHome, away: htAway } = parseHTScore(match);
                const winnerLeft = leftScore > rightScore;
                const winnerRight = leftScore < rightScore;
                const scoreFT = `${leftScore} x ${rightScore}`;
                const htLeft = isPlayer1Home ? htHome : htAway;
                const htRight = isPlayer1Home ? htAway : htHome;
                const scoreHT = (htLeft || htRight) ? `HT: ${htLeft}-${htRight}` : '';

                const matchItem = document.createElement('div');
                matchItem.className = 'history-match';
                matchItem.style.display = 'grid';
                matchItem.style.gridTemplateColumns = '1fr 80px 1fr';
                matchItem.style.alignItems = 'center';
                matchItem.style.padding = '8px 0';
                matchItem.style.borderBottom = '1px solid var(--text-muted)';

                const leftDiv = document.createElement('div');
                leftDiv.className = `history-team ${winnerLeft ? 'winner' : ''}`;
                leftDiv.textContent = leftPlayer;
                leftDiv.style.textAlign = 'left';

                const centerDiv = document.createElement('div');
                centerDiv.className = 'history-score';
                centerDiv.textContent = scoreFT;
                centerDiv.style.textAlign = 'center';
                centerDiv.style.fontWeight = '700';

                const rightDiv = document.createElement('div');
                rightDiv.className = `history-team ${winnerRight ? 'winner' : ''}`;
                rightDiv.textContent = rightPlayer;
                rightDiv.style.textAlign = 'right';

                matchItem.appendChild(leftDiv);
                matchItem.appendChild(centerDiv);
                matchItem.appendChild(rightDiv);

                if (scoreHT) {
                    const htDiv = document.createElement('div');
                    htDiv.className = 'history-ht';
                    htDiv.textContent = scoreHT;
                    htDiv.style.gridColumn = '1 / -1';
                    htDiv.style.textAlign = 'center';
                    htDiv.style.color = 'var(--text-muted)';
                    htDiv.style.fontSize = '0.8rem';
                    htDiv.style.marginTop = '4px';
                    matchItem.appendChild(htDiv);
                }

                return matchItem;
            };

            h2hMatchesData.forEach(match => {
                const matchItem = createH2HMatchItem(match);
                h2hMatchesElem.appendChild(matchItem);
            });

            // H2H Summary
            const h2hSummary = calculateH2HSummary(h2hMatchesData);
            h2hSummaryElem.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${h2hSummary.player1Wins}</div>
                    <div class="stat-label">Vit√≥rias ${currentPlayer1}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${h2hSummary.player2Wins}</div>
                    <div class="stat-label">Vit√≥rias ${currentPlayer2}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${h2hSummary.draws}</div>
                    <div class="stat-label">Empates</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${h2hSummary.zeroZero}</div>
                    <div class="stat-label">0 x 0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${h2hSummary.btts}</div>
                    <div class="stat-label">BTTS</div>
                </div>
            `;

            // Player 1 Summary
            const player1Summary = calculatePlayerSummary(player1MatchesData, currentPlayer1);
            player1SummaryElem.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${player1Summary.wins}</div>
                    <div class="stat-label">Vit√≥rias</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${player1Summary.losses}</div>
                    <div class="stat-label">Derrotas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${player1Summary.draws}</div>
                    <div class="stat-label">Empates</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${player1Summary.zeroZero}</div>
                    <div class="stat-label">0 x 0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${player1Summary.btts}</div>
                    <div class="stat-label">BTTS</div>
                </div>
            `;

            // Player 2 Summary
            const player2Summary = calculatePlayerSummary(player2MatchesData, currentPlayer2);
            player2SummaryElem.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${player2Summary.wins}</div>
                    <div class="stat-label">Vit√≥rias</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${player2Summary.losses}</div>
                    <div class="stat-label">Derrotas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${player2Summary.draws}</div>
                    <div class="stat-label">Empates</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${player2Summary.zeroZero}</div>
                    <div class="stat-label">0 x 0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${player2Summary.btts}</div>
                    <div class="stat-label">BTTS</div>
                </div>
            `;

            // Update active tab
            document.querySelectorAll('.metric-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`.metric-tab[onclick="showMetrics('${period}')"]`).classList.add('active');

            document.getElementById('loading-h2h').style.display = 'none';
            document.getElementById('h2h-content').style.display = 'block';
        }

        function openH2H(player1, player2) {
            openTab('h2h');
            fetchH2HData(player1, player2);
        }

        function goBack() {
            window.location.href = 'visualization.html';
        }

        function startLiveUpdate() {
            if (liveUpdateInterval) clearInterval(liveUpdateInterval);
            liveUpdateInterval = setInterval(() => {
                if (document.getElementById('live-tab').classList.contains('active')) {
                    fetchLiveMatches();
                }
            }, 10000); // Atualiza a cada 10 segundos
        }

        function stopLiveUpdate() {
            if (liveUpdateInterval) {
                clearInterval(liveUpdateInterval);
                liveUpdateInterval = null;
            }
        }

        function openTab(tabName) {
            const tabButton = document.querySelector(`.tab-button[onclick="openTab('${tabName}')"]`);
            const tabContent = document.getElementById(`${tabName}-tab`);

            if (!tabButton || !tabContent) return;

            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            tabButton.classList.add('active');
            tabContent.classList.add('active');

            if (tabName === 'live') {
                const liveContent = document.getElementById('matches-live-content');
                if (liveContent && !liveContent.innerHTML) {
                    fetchLiveMatches();
                }
                startLiveUpdate();
            } else {
                stopLiveUpdate();
                if (tabName === 'finished') {
                    const finishedContent = document.getElementById('matches-finished-content');
                    if (finishedContent && !finishedContent.innerHTML) {
                        fetchFinishedMatches();
                    }
                }
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            window.initialLoad = true;
            openTab('live');
        });
    </script>
</body>

</html>